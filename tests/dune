(executable
 (name extract_tests)
 (libraries str)
 (modules extract_tests))

(rule
 (with-stdout-to
  dune.inc.new
  (run ./extract_tests.exe -write-dune-file
       %{dep:spec.txt}
       %{dep:attributes.md}
       %{dep:def_list.md})))

(include dune.inc)

(executable
 (name omd_tyxml)
 (libraries str omd tyxml omd_tyxml)
 (modules omd_tyxml))

(rule
 (alias test_omd_tyxml)
 (action (run ./omd_tyxml.exe)))

(alias
 (name runtest)
 (deps
  (alias test-specs)
  (alias test_omd_tyxml)))

(executable
 (name omd)
 (libraries str omd)
 (modules omd))

(rule
 (alias gen)
 (action (diff dune.inc dune.inc.new)))
